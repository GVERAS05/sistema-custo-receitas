<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Custos de Receita</title>
<style>
  /* ===== Geral ===== */
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #FAF9F6;
    color: #212121;
    margin: 0;
    padding: 0;
  }

  header {
    background: #1E88E5;
    color: #fff;
    padding: 1rem;
    text-align: center;
    font-size: 1.5rem;
    font-weight: bold;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }

  .container {
    max-width: 1200px;
    margin: auto;
    padding: 1rem;
  }

  /* ===== Busca ===== */
  .busca {
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
  }
  .busca input {
    flex: 1;
    padding: 0.5rem 0.75rem;
    border: 1px solid #E0E0E0;
    border-radius: 8px 0 0 8px;
    font-size: 1rem;
  }
  .busca img {
    width: 32px;
    height: 32px;
    background: #E0E0E0;
    padding: 4px;
    border-radius: 0 8px 8px 0;
    cursor: pointer;
  }

  /* ===== Lista de ingredientes ===== */
  #lista div {
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid #BDBDBD;
    cursor: pointer;
    transition: background 0.2s;
  }
  #lista div:hover {
    background: #E0E0E0;
  }

  /* ===== Cards ===== */
  .card-item {
    background: #FCFCFC;
    border: 1px solid #E0E0E0;
    border-radius: 12px;
    padding: 1rem;
    margin-bottom: 1rem;
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
  }
  .card-item:hover {
    box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    transform: translateY(-2px);
  }
  .card-header {
    font-weight: bold;
    margin-bottom: 0.5rem;
    font-size: 1.1rem;
  }
  .input-group {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    align-items: center;
  }
  .input-group input, .input-group select {
    padding: 0.5rem;
    border: 1px solid #E0E0E0;
    border-radius: 8px;
    font-size: 0.95rem;
    flex: 1;
  }
  .input-group .custo {
    min-width: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1rem;
    color: #1E88E5;
  }
  .input-group button {
    background: #E53935;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 0.5rem 1rem;
    cursor: pointer;
    transition: background 0.2s;
  }
  .input-group button:hover {
    background: #B71C1C;
  }

  /* ===== Total ===== */
  #total-container {
    text-align: right;
    font-size: 1.25rem;
    font-weight: bold;
    margin-top: 1rem;
  }
</style>
</head>
<body>

<header>
  Sistema de Custos de Receita
</header>

<div class="container">
  <div class="busca">
    <input type="text" id="busca" placeholder="Pesquisar ingrediente...">
    <img src="https://cdn-icons-png.flaticon.com/512/622/622669.png" alt="Lupa">
  </div>

  <div id="lista"></div>
  <div id="cardsContainer"></div>
  <div id="total-container">
    Total: R$ <span id="total">0.00</span>
  </div>
</div>

<script>
// ============================
// Ingredientes e unidades
// ============================
const ingredientes = [
"Ácido Cítrico","Açúcar Refinado","Açúcar Sc.","Ajinomoto","Alho de Natural",
"Amido de milho","Aroma de Baunilia","Aroma de Cebola","Aroma de Chocolate",
"Aroma de Leite Condensado","Aroma de Coco","Aroma de Três Leite","Aroma de Maisena",
"Aroma de Manteiga","Aroma de Maria","Aroma de Milho","Aroma Alho","Caramelo",
"Aroma de Quijo Parmesão","Bicarbonato de Amônio","Bicarbonato de Sódio","Cacau em pó",
"Cebola Natural Roxa","Caixa de Papelão","Emb. Saco Fd. 50x80","Chocolate em Pó",
"Embalagem Transp. Lisa","Embalagem folhada Cebola","Embalagem folhada Alho",
"Embalagem Folhada Manteiga","Milho Inatura","Farelo","Fubá de milho","Embalagem Milho",
"Ezimas","Embalagem 8 Grãos","Embalagem Água e Sal","Embalagem Integral","Emb. Rainha Maisena",
"Emb. Rainha Leite","Emb. Rainha Cracker","Emb. Rainha Rosca Leite","Emb. Rainha Rosca Chocolate",
"Emb. Rainha Rosca Coco","Emb. Rainha Manteiga","Emb. Rainha Alho","Emb. Rainha Cebola",
"Farinha de Trigo Fama Panificação","Farinha de Trigo Panete Comum","Farinha de Trigo Evita 2",
"Fécula de Mandioca","Fermento Instantãneo","Gordura Agropalma","Lecetina de Soja Tb.",
"Manteiga Itacolomir","Margarina Folhada Rica","Margarina puro sabor bd.","Margarina","Mel Caseiro",
"Metabisulfito","Óleo de Soja","Milho Gelatinizado","Gordura Liquida Vegetal","Paulialfa",
"Paulitase","Paulivita","Pirofosfato","Sal Micronizado","Sal Refinado","Soro de Leite",
"Unimelo","etiquetas conchita","Embalagem de Caixa p/ Folhada","Óleo Pronto Cebola",
"Filme Rezinite","Fita Sela Caixa","Gelatina de Milho","Embalagem Flocão","Embalagem Dallato Leite",
"Embalagem Dallato Coco","Embalagem Dallato Chocolate","Aroma de Limão","Farofa","B. de Amonio",
"Farinha de Trigo Sc","Sal Kg.","Margarina M. Ouro","Amido de Milho","Gordura Hid.",
"Tempero Cebola","Óleo de Soja","Cebola Natural","Tempero Mant.","Mant. Itacolomir","Tempero Alho",
"Esponja","Fermento","Paulivita","Açucar"
];

const unidades = [
  {label:"Kg", value:"kg"},
  {label:"g", value:"g"},
  {label:"L", value:"L"},
  {label:"mL", value:"mL"},
  {label:"unidade", value:"unidade"}
];

// ============================
// Variáveis
// ============================
let itensAdicionados = {};
const cardsContainer = document.getElementById("cardsContainer");
const buscaInput = document.getElementById("busca");
const listaDiv = document.getElementById("lista");

// ============================
// LocalStorage histórico de preços
// ============================
function salvarHistorico(nome, preco){
  let historico = JSON.parse(localStorage.getItem("historicoPrecos")) || {};
  historico[nome] = preco;
  localStorage.setItem("historicoPrecos", JSON.stringify(historico));
}
function pegarHistorico(nome){
  let historico = JSON.parse(localStorage.getItem("historicoPrecos")) || {};
  return historico[nome] || "";
}

// ============================
// Adicionar item
// ============================
function adicionarItem(nome){
  if(itensAdicionados[nome]) return;
  itensAdicionados[nome]=true;

  const card = document.createElement("div");
  card.className="card-item";
  card.dataset.nome = nome;

  const precoHistorico = pegarHistorico(nome);

  card.innerHTML = `
    <div class="card-header">${nome}</div>
    <div class="input-group">
      <input type="number" placeholder="Custo" step="0.01" value="${precoHistorico}" oninput="calcularEAtualizarHistorico(this,'${nome}')">
      <input type="number" placeholder="Qtd" step="0.001" oninput="calcular()">
      <select onchange="calcular()">
        ${unidades.map(u=>`<option value="${u.value}">${u.label}</option>`).join("")}
      </select>
      <div class="custo">R$ 0.00</div>
      <button onclick="removerItem(this)">Remover</button>
    </div>
  `;
  cardsContainer.appendChild(card);
  buscaInput.value = "";
  mostrarLista(ingredientes);
}

// ============================
// Atualizar histórico
// ============================
function calcularEAtualizarHistorico(input, nome){
  calcular();
  salvarHistorico(nome, parseFloat(input.value)||0);
}

// ============================
// Calcular subtotal e total
// ============================
function calcular(){
  let total = 0;
  document.querySelectorAll(".card-item").forEach(card=>{
    const inputs = card.querySelectorAll("input[type=number]");
    const custo = parseFloat(inputs[0].value) || 0;
    const qtd = parseFloat(inputs[1].value) || 0;
    const subtotal = custo * qtd;
    card.querySelector(".custo").textContent = "R$ " + subtotal.toFixed(2);
    total += subtotal;
  });
  document.getElementById("total").textContent = total.toFixed(2);
}

// ============================
// Remover item
// ============================
function removerItem(botao){
  const card = botao.closest(".card-item");
  delete itensAdicionados[card.dataset.nome];
  card.remove();
  calcular();
  mostrarLista(ingredientes);
}

// ============================
// Mostrar lista filtrada
// ============================
function mostrarLista(array){
  listaDiv.innerHTML="";
  array.forEach(item=>{
    const div = document.createElement("div");
    div.textContent=item;
    div.style.cursor="pointer";
    div.onclick=()=>adicionarItem(item);
    listaDiv.appendChild(div);
  });
}

// ============================
// Pesquisa ingredientes
// ============================
buscaInput.addEventListener("input", e=>{
  const val = e.target.value.toLowerCase();
  const filtrados = ingredientes.filter(i=>i.toLowerCase().includes(val));
  mostrarLista(filtrados);
});

// ============================
// Inicial
// ============================
mostrarLista(ingredientes);
</script>

</body>
</html>
