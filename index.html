<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Calculadora de Custos da Receita</title>
<style>
body { font-family: Arial; padding: 20px; }
input, select, button { padding: 4px; margin: 2px; }
table { border-collapse: collapse; width: 100%; margin-top: 10px; }
th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
#listaItens { border: 1px solid #ccc; max-height: 250px; overflow-y: auto; padding: 0; margin-top: 5px; }
#listaItens li { list-style: none; padding: 6px; cursor: pointer; }
#listaItens li:hover { background: #eee; }
button { cursor: pointer; }
.total { font-weight: bold; font-size: 18px; margin-top: 10px; }

/* Lupa dentro do input */
.input-lupa {
  position: relative;
  display: inline-block;
  width: 100%;
}

.input-lupa input {
  width: 100%;
  padding-left: 30px; /* espa√ßo para a lupa */
  box-sizing: border-box;
}

.input-lupa::before {
  content: "üîç"; /* emoji de lupa */
  position: absolute;
  left: 8px;
  top: 6px;
  pointer-events: none; /* n√£o bloqueia digita√ß√£o */
  font-size: 16px;
}
</style>
</head>

<body>

<h2>Buscar item (lupa)</h2>
<div class="input-lupa">
  <input type="text" id="busca" placeholder="Digite para buscar..." onkeyup="filtrarLista()">
</div>
<ul id="listaItens"></ul>

<h2>Receita</h2>
<table>
<thead>
<tr>
  <th>Item</th>
  <th>Custo por unidade (R$)</th>
  <th>Quantidade usada</th>
  <th>Unidade</th>
  <th>Custo do item (R$)</th>
  <th>Remover</th>
</tr>
</thead>
<tbody id="tabelaItens"></tbody>
</table>

<p class="total">Custo total da receita: R$ <span id="total">0.00</span></p>

<script>
// ===== BASE COMPLETA DE INGREDIENTES =====
const ingredientes = [
"√Åcido C√≠trico","A√ß√∫car Refinado","A√ß√∫car Sc.","Ajinomoto","Alho Natural","Amido de milho",
"Aroma de Baunilha","Aroma de Cebola","Aroma de Chocolate","Aroma de Leite Condensado","Aroma de Coco",
"Aroma de Tr√™s Leite","Aroma de Maisena","Aroma de Manteiga","Aroma de Maria","Aroma de Milho",
"Aroma Alho","Caramelo","Aroma de Queijo Parmes√£o","Bicarbonato de Am√¥nio","Bicarbonato de S√≥dio",
"Cacau em p√≥","Cebola Natural Roxa","Caixa de Papel√£o","Emb. Saco Fd. 50x80","Chocolate em P√≥",
"Embalagem Transp. Lisa","Embalagem folhada Cebola","Embalagem folhada Alho","Embalagem Folhada Manteiga",
"Milho Inatura","Farelo","Fub√° de milho","Embalagem Milho","Ezimas","Embalagem 8 Gr√£os",
"Embalagem √Ågua e Sal","Embalagem Integral","Emb. Rainha Maisena","Emb. Rainha Leite","Emb. Rainha Cracker",
"Emb. Rainha Rosca Leite","Emb. Rainha Rosca Chocolate","Emb. Rainha Rosca Coco","Emb. Rainha Manteiga",
"Emb. Rainha Alho","Emb. Rainha Cebola","Farinha de Trigo Fama Panifica√ß√£o","Farinha de Trigo Panete Comum",
"Farinha de Trigo Evita 2","F√©cula de Mandioca","Fermento Instant√¢neo","Gordura Agropalma","Lecetina de Soja",
"Manteiga Itacolomir","Margarina Folhada Rica","Margarina puro sabor","Margarina","Mel Caseiro",
"Metabisulfito","√ìleo de Soja","Milho Gelatinizado","Gordura L√≠quida Vegetal","Paulialfa","Paulitase",
"Paulivita","Pirofosfato","Sal Micronizado","Sal Refinado","Soro de Leite","Unimelo","Etiquetas Conchita",
"Embalagem de Caixa p/ Folhada","√ìleo Pronto Cebola","Filme Rezinite","Fita Sela Caixa","Gelatina de Milho",
"Embalagem Floc√£o","Embalagem Dallato Leite","Embalagem Dallato Coco","Embalagem Dallato Chocolate",
"Aroma de Lim√£o","Farofa","B. de Am√¥nio","Farinha de Trigo Sc","Sal","Margarina M. Ouro","Amido de Milho",
"Gordura Hid.","Tempero Cebola","Tempero Mant.","Tempero Alho","Esponja","Fermento","Paulivita",
"A√ß√∫car"
].sort();

// ===== UNIDADES NA ORDEM CORRETA =====
const unidades = [
  { label: "Unidade", value: "un" },
  { label: "Quilo (kg)", value: "kg" },
  { label: "Grama (g)", value: "g" },
  { label: "Litro (L)", value: "L" },
  { label: "Mililitro (ml)", value: "ml" }
];

// ===== POPULAR LISTA =====
const listaUL = document.getElementById("listaItens");
const tabelaItens = document.getElementById("tabelaItens");
let itensAdicionados = {};

function mostrarLista(itens) {
  listaUL.innerHTML = "";
  itens.forEach(item => {
    if(itensAdicionados[item]) return; // n√£o mostrar j√° adicionados
    const li = document.createElement("li");
    li.textContent = item;
    li.onclick = () => adicionarItem(item);
    listaUL.appendChild(li);
  });
}

// Mostrar todos os itens inicialmente
mostrarLista(ingredientes);

// ===== FILTRAR LISTA =====
function filtrarLista() {
  const txt = document.getElementById("busca").value.toLowerCase();
  mostrarLista(ingredientes.filter(i => i.toLowerCase().includes(txt)));
}

// ===== ADICIONAR ITEM =====
function adicionarItem(nome){
  if(itensAdicionados[nome]) return;
  itensAdicionados[nome] = true;

  const tr = document.createElement("tr");
  tr.dataset.nome = nome;

  tr.innerHTML = `
    <td>${nome}</td>
    <td><input type="number" step="0.01" oninput="calcular()"></td>
    <td><input type="number" step="0.001" oninput="calcular()"></td>
    <td>
      <select onchange="calcular()">
        ${unidades.map(u => `<option value="${u.value}">${u.label}</option>`).join("")}
      </select>
    </td>
    <td class="custo">0.00</td>
    <td><button onclick="removerItem(this)">‚ùå</button></td>
  `;

  tabelaItens.appendChild(tr);

  // Atualizar lista e limpar busca
  document.getElementById("busca").value = "";
  mostrarLista(ingredientes);
}

// ===== CALCULAR =====
function calcular(){
  let total = 0;
  document.querySelectorAll("#tabelaItens tr").forEach(tr => {
    const custoUnit = parseFloat(tr.children[1].children[0].value) || 0;
    const qtd = parseFloat(tr.children[2].children[0].value) || 0;
    const subtotal = custoUnit * qtd;
    tr.querySelector(".custo").textContent = subtotal.toFixed(2);
    total += subtotal;
  });
  document.getElementById("total").textContent = total.toFixed(2);
}

// ===== REMOVER ITEM =====
function removerItem(botao){
  const tr = botao.closest("tr");
  delete itensAdicionados[tr.dataset.nome];
  tr.remove();
  calcular();
  mostrarLista(ingredientes);
}
</script>

</body>
</html>
